<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Corre√ß√µes Timeline - DashPMO</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f5f5f5; 
        }
        .timeline-card { 
            border: 1px solid #ccc; 
            border-radius: 8px; 
            padding: 20px; 
            margin: 20px 0; 
            background: white; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .timeline-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 20px; 
        }
        .nav-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 0 4px;
        }
        .nav-button:hover {
            background: #2563eb;
        }
        .nav-button:disabled {
            background: #d1d5db;
            cursor: not-allowed;
        }
        .timeline-desktop {
            position: relative;
            height: 200px;
            border: 1px dashed #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }
        .timeline-element {
            position: absolute;
            background: #6366f1;
            color: white;
            padding: 10px;
            border-radius: 8px;
            min-width: 120px;
            text-align: center;
            font-size: 12px;
        }
        .timeline-element:nth-child(1) { left: 10%; background: #ef4444; }
        .timeline-element:nth-child(2) { left: 35%; background: #f59e0b; }
        .timeline-element:nth-child(3) { left: 60%; background: #10b981; }
        .timeline-element:nth-child(4) { left: 85%; background: #6366f1; }
        .timeline-element:nth-child(5) { left: 10%; top: 100px; background: #8b5cf6; }
        .timeline-element:nth-child(6) { left: 35%; top: 100px; background: #06b6d4; }
        .timeline-element:nth-child(7) { left: 60%; top: 100px; background: #84cc16; }
        .log-area {
            background: #1f2937;
            color: #f9fafb;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            height: 200px;
            overflow-y: auto;
            margin-top: 20px;
        }
        .status-info {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .warning { color: #f59e0b; }
    </style>
</head>
<body>
    <h1>üß™ Teste de Corre√ß√µes - Timeline Navigation</h1>
    
    <div class="status-info">
        <h3>‚úÖ Corre√ß√µes Implementadas:</h3>
        <ul>
            <li><strong>Problema 1:</strong> Setas navegando para in√≠cio do projeto ‚û°Ô∏è <span class="success">CORRIGIDO</span></li>
            <li><strong>Problema 2:</strong> Bloco de resumo do status desapareceu ‚û°Ô∏è <span class="success">CORRIGIDO</span></li>
        </ul>
        <p><strong>Teste:</strong> As setas abaixo devem paginar apenas dentro da timeline, n√£o navegar para outra p√°gina.</p>
    </div>

    <!-- Timeline Container Simulada -->
    <div class="timeline-card" data-timeline-container="0">
        <div class="timeline-header">
            <h3 class="card-title">Timeline de Entregas - Nova POC (1 de 3)</h3>
            <div class="timeline-nav">
                <button 
                    class="nav-button" 
                    data-direction="left" 
                    id="timeline-left-0-0"
                    onclick="navigateTimelineArrow('timeline-left-0-0', 'left', 0); return false;"
                    aria-label="P√°gina anterior"
                >
                    ‚óÄ Anterior
                </button>
                <button 
                    class="nav-button" 
                    data-direction="right" 
                    id="timeline-right-0-0"
                    onclick="navigateTimelineArrow('timeline-right-0-0', 'right', 0); return false;"
                    aria-label="Pr√≥xima p√°gina"
                >
                    Pr√≥xima ‚ñ∂
                </button>
            </div>
        </div>
        
        <div class="timeline-desktop">
            <!-- Elementos da timeline que devem ser paginados -->
            <div class="timeline-element" data-timeline-index="0" data-timeline-visible="true">
                Entrega 1<br/>02/07/2025
            </div>
            <div class="timeline-element" data-timeline-index="1" data-timeline-visible="true">
                Entrega 2<br/>04/07/2025
            </div>
            <div class="timeline-element" data-timeline-index="2" data-timeline-visible="true">
                Entrega 3<br/>07/07/2025
            </div>
            <!-- Elementos ocultos que aparecem na pr√≥xima p√°gina -->
            <div class="timeline-element" data-timeline-index="3" data-timeline-visible="false" style="display: none;">
                Entrega 4<br/>08/07/2025
            </div>
            <div class="timeline-element" data-timeline-index="4" data-timeline-visible="false" style="display: none;">
                Entrega 5<br/>14/07/2025
            </div>
            <div class="timeline-element" data-timeline-index="5" data-timeline-visible="false" style="display: none;">
                Entrega 6<br/>21/07/2025
            </div>
            <!-- √öltima p√°gina -->
            <div class="timeline-element" data-timeline-index="6" data-timeline-visible="false" style="display: none;">
                Entrega 7<br/>28/07/2025
            </div>
        </div>
    </div>

    <!-- Log Area -->
    <div id="log-area" class="log-area">
        <div class="success">[SISTEMA] Timeline de teste carregada</div>
        <div>[INFO] Clique nas setas para testar a navega√ß√£o</div>
        <div>[INFO] Os logs de navega√ß√£o aparecer√£o aqui</div>
    </div>

    <script>
        // Configura√ß√£o inicial da timeline
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.querySelector('[data-timeline-container="0"]');
            container.setAttribute('data-timeline-current-page', '0');
            container.setAttribute('data-timeline-total-items', '7');
            container.setAttribute('data-timeline-items-per-page', '3');
            
            log('üîß Timeline inicializada: 7 elementos, 3 por p√°gina, p√°gina atual: 0');
        });

        // Fun√ß√£o de log
        function log(message) {
            const logArea = document.getElementById('log-area');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            logArea.appendChild(logEntry);
            logArea.scrollTop = logArea.scrollHeight;
            console.log(message);
        }

        // Fun√ß√£o principal para navega√ß√£o das setas da timeline (vers√£o corrigida)
        function navigateTimelineArrow(arrowId, direction, containerIndex) {
            log(`üéØ Navega√ß√£o ativada: ${arrowId}, dire√ß√£o: ${direction}, container: ${containerIndex}`);
            
            try {
                // Encontrar o container da timeline
                const container = document.querySelector(`[data-timeline-container="${containerIndex}"]`);
                if (!container) {
                    log('‚ùå Container da timeline n√£o encontrado: ' + containerIndex);
                    return false;
                }
                
                // Obter informa√ß√µes do estado atual
                let currentPage = parseInt(container.getAttribute('data-timeline-current-page') || '0');
                let totalItems = parseInt(container.getAttribute('data-timeline-total-items') || '0');
                const itemsPerPage = parseInt(container.getAttribute('data-timeline-items-per-page') || '3');
                
                log(`üìä Estado atual: p√°gina ${currentPage}, ${totalItems} itens, ${itemsPerPage} por p√°gina`);
                
                // Calcular nova p√°gina
                let newPage = currentPage;
                const maxPages = Math.ceil(totalItems / itemsPerPage) - 1;
                
                if (direction === 'left') {
                    newPage = Math.max(0, currentPage - 1);
                } else if (direction === 'right') {
                    newPage = Math.min(maxPages, currentPage + 1);
                }
                
                // Se n√£o mudou a p√°gina, n√£o fazer nada
                if (newPage === currentPage) {
                    log(`‚ö†Ô∏è J√° na p√°gina limite: ${currentPage}`);
                    return false;
                }
                
                log(`‚û°Ô∏è Mudando da p√°gina ${currentPage} para ${newPage}`);
                
                // CORRE√á√ÉO: Navega√ß√£o puramente JavaScript sem tentar clicar nos bot√µes React
                const success = switchTimelinePage(container, newPage, itemsPerPage, totalItems);
                
                if (success) {
                    // Atualizar o estado do container
                    container.setAttribute('data-timeline-current-page', newPage.toString());
                    
                    // CORRE√á√ÉO: Atualizar t√≠tulo se poss√≠vel
                    const titleElement = container.querySelector('[class*="CardTitle"], h3, h4');
                    if (titleElement && titleElement.textContent && titleElement.textContent.includes('(')) {
                        const newTitle = titleElement.textContent.replace(/\((\d+) de (\d+)\)/, `(${newPage + 1} de ${Math.ceil(totalItems / itemsPerPage)})`);
                        titleElement.textContent = newTitle;
                        log(`üìù T√≠tulo atualizado: ${newTitle}`);
                    }
                    
                    log(`‚úÖ Navega√ß√£o conclu√≠da! Nova p√°gina: ${newPage}`);
                } else {
                    log(`‚ùå Falha na navega√ß√£o`);
                }
                
                return false; // Prevenir propaga√ß√£o do evento
                
            } catch (error) {
                log('‚ùå Erro na navega√ß√£o da timeline: ' + error.message);
                return false;
            }
        }

        // FUN√á√ÉO CORRIGIDA: Trocar p√°gina da timeline sem tentar clicar nos bot√µes React
        function switchTimelinePage(container, newPage, itemsPerPage, totalItems) {
            log(`üîÑ Alternando para p√°gina ${newPage}`);
            
            try {
                log(`üîß Manipula√ß√£o direta do DOM para navega√ß√£o da timeline`);
                
                // Encontrar todos os elementos da timeline
                const allTimelineElements = container.querySelectorAll(
                    '.timeline-element, .timeline-box, [class*="absolute"][style*="left"], [style*="position: absolute"], .delivery-item, [data-entrega], [class*="absolute"][class*="transform"]'
                );
                
                log(`üì¶ Encontrados ${allTimelineElements.length} elementos da timeline`);
                
                if (allTimelineElements.length === 0) {
                    log('‚ùå Nenhum elemento da timeline encontrado');
                    return false;
                }
                
                // NOVA ABORDAGEM: Manipular visibilidade dos elementos existentes
                const startIndex = newPage * itemsPerPage;
                const endIndex = Math.min(startIndex + itemsPerPage, allTimelineElements.length);
                
                log(`üìä Mostrando elementos ${startIndex} a ${endIndex - 1} de ${allTimelineElements.length}`);
                
                // Ocultar todos os elementos primeiro
                allTimelineElements.forEach((el, index) => {
                    const element = el;
                    element.style.display = 'none';
                    element.style.visibility = 'hidden';
                    element.style.opacity = '0';
                    element.setAttribute('data-timeline-visible', 'false');
                });
                
                // Mostrar apenas os elementos da p√°gina atual
                for (let i = startIndex; i < endIndex; i++) {
                    if (i < allTimelineElements.length) {
                        const element = allTimelineElements[i];
                        element.style.display = 'block';
                        element.style.visibility = 'visible';
                        element.style.opacity = '1';
                        element.setAttribute('data-timeline-visible', 'true');
                    }
                }
                
                log(`‚úÖ P√°gina ${newPage} ativada com ${endIndex - startIndex} elementos vis√≠veis`);
                return true;
                
            } catch (error) {
                log(`‚ùå Erro na manipula√ß√£o do DOM: ${error.message}`);
                return false;
            }
        }

        log('üéØ Script de navega√ß√£o da timeline carregado e pronto para teste');
    </script>
</body>
</html> 